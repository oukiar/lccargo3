<!DOCTYPE html><html>    <head>		        <meta http-equiv="content-type" content="text/html;charset=UTF-8" />        <meta charset="utf-8" />        <title>LC Cargo</title>        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />        <meta content="" name="description" />        <meta content="" name="author" />        <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Jura&amp;subset=all">       	   <!--ADMIN REQUIREMENTS-->     <% include ../../generals/ultraAdmin.ejs %>	            <script src="/cod/js/common.js"></script>        <script src="/cod/js/moment.js"></script>        <script src="/cod/js/ejs_production.js"></script>            <script src="/cod/js/jquery-1.11.2.min.js"></script>        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css" />        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>        <script src="http://yui.yahooapis.com/3.6.0/build/yui/yui-min.js"></script>        <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.0.19.min.js"></script>        </head>    <!-- END HEAD -->    <!-- BEGIN BODY -->    <body>		<!--START TOPBAR-->		 <% include ../../generals/topbar.ejs %>		         <!-- START CONTAINER -->        <div class="page-container row-fluid">        <!-- SIDEBAR - START -->		 <% include ../../generals/sideBar.ejs %>        <!--  SIDEBAR - END -->						            <!-- START CONTENT -->                     <section class="wrapper" style='margin-top:60px;display:inline-block;width:100%;padding:15px 0 0 15px;'>              <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>              <div class="page-title">              <div class="pull-left">		  			  <% include labelsMenu.ejs %>              <h1 class="title">Warehouse - Repack</h1>			  			  			  			  	  	  <fieldset class="container">	  			 			  	    <div class="row">	  	      <div class="col-lg-12 col-md-12 container">	  	                      	  	            <div class="col-md-6 col-xs-6">													  	            </div>						  	            <div class="col-md-6 col-xs-6" style="margin-top:10px;">					<div style="float:right">			Search client: <input id="txt_name" name="txt_name">                    </div>                    </div>					               	          <div class="panel"> 	            <div class="panel-body"> 	              <ul id="list"> 	                <table>                        <div id="repack_content" name="repack_content" >						                                                <button id="btn_index">Index</button>                                            </div>                </table>  	              </ul>  	            </div>  	          </div>			  			  			        </div>			        			      </div>			 			  </fieldset>	  			  		      </div>              </div>              </div>            </section>            <!-- END CONTENT -->                         </div><!-- END CONTAINER -->        <!-- LOAD FILES AT PAGE END FOR FASTER LOADING --><%include ../../generals/endFiles.ejs%>        <!-- modal end -->    <div id="openModal" class="modalDialogB">        <div>            <a href="#close" title="Close" class="closeB">X</a>            <div id="repack_form">            </div>        </div>    </div>    		        <script>            Parse.initialize("XEPryFHrd5Tztu45du5Z3kpqxDsweaP1Q0lt8JOb", "MDhb1hBngr2tx2v9TjyzoUhMcOFeWGJ56TWvChqi");            $("#btn_index").click(function(){            var query = new Parse.Query("Clients");            query.descending('createdAt');            query.find({                success:                     function(results)                    {                        for(i in results)                        {                            results[i].set("name_lower", results[i].get("Name").toLowerCase());                            results[i].save();                        }                                                alert("DONE");                    }                });        });            /* ESTA VARIABLE ALMACENA EL OBJECTID DEL USUARIO SELECCIONADO */    usrID = -1;  	$( "#txt_name" ).autocomplete({source: []});        $("#txt_name").keyup(		function(){			var myval = $("#txt_name").val();                        var query = new Parse.Query("Clients");            query.descending('createdAt');            query.contains("name_lower", myval);            query.find({                success:                     function(results)                    {                        var newresult = [];                                                for(i in results)                            newresult.push({label:results[i].get("Name"), idx:results[i].id});                                                    $("#txt_name").autocomplete({source: newresult});                           $("#txt_name").trigger("keydown");                    }                });        });                function update_table_repack()        {            /*            var query = new Parse.Query("Warehouses");            query.descending('createdAt');            query.equalTo("Consignee", {__type: "Pointer", className: "Clients", objectId: usrID});            query.find({                success:                     function(results)                    {                        var html = new EJS({url: '/web/Staff/Warehouses/Repack/RepackTable.ejs'}).render(results);                        alert(html);                    }                });                        return;*/                        if($("#warehousefilter").val() == "")                conditions = {"equalTo": {"Status":"Received"}};            else                conditions = {"equalTo": {"Status":"Received", Warehouse:$("#warehousefilter").val()}};                            InsertTable({                    cols:   /*Columnas definidas FIELD:TITLE or FIELD:{FIELDNEEDED:FIELDTITLE}*/                         {                                                        "Receipt":"",                            "Shipper":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/                            "ReceiptDate":"",                            "Country":"",                            "Volume":"",                            "Warehouse":"",                            "Invoice":"",                            "Transport":"",                            "objectId":""                        },                                            /* AL PASAR EL PARAMETRO COLLECTION INDICAMOS QUE NECESITAMOS BUSQUEDA CON LISTA DE RESULTADOS */                    collection: "Warehouses", /* COLLECCION PRINCIPAL */                    by: "Consignee",    /* CAMPO DE BUSQUEDA */                    value: {__type: "Pointer", className: "Clients", objectId: usrID},                                        conditions: conditions,                    /*conditions: {"notEqualTo": {'Repack' :  {__type: "Pointer", className: "Clients", objectId:""}}},*/                                        document: "Staff/Warehouses/repack_partitions/RepackTable",                    itemid: "repack_content"                });                                            InsertForm({                        document: "Staff/Warehouses/repack_partitions/RepackForm",                        itemid: "repack_form"                });                    }                $("#warehousefilter").change(function(){            if(usrID != -1)                update_table_repack();        });                /*CLIENT SELECCION FROM THE RESULT*/        $( "#txt_name" ).autocomplete({             select: 			 function( event, ui ){                                        usrID = ui.item.idx;                    update_table_repack();                }          });           repack_items = [];     repack_labels = [];              </script>            </body>	</html>
<div id="repack_content">

        
        <div class="row">
            <div class="col-lg-12 col-md-12 container">
                <div class="row">
                
                    
                    <div class="col-md-6 col-xs-6">
                    
						<table>
						<tr>
							<th>
								<label for="showWarehouse" class="pfont">WareHouse:</label>
							</th>
							<th>
								<label for="filterby" class="pfont">By:</label>
							</th>
							<th>
								<label class="pfont"  style="display: none;" id="fromTxt">From:</label>
							</th>
							<th>
  <label class="pfont" id="toTxt">Date:</label>
</th>							
							
							
							<tr>
					<!--COLUMN 1-->			
 				<td style="padding: 5px;"> 
				<select  id="warehousefilter" name="warehousefilter">
 			    <!--IF ALL SHOW DATE SELECT OPTIONS-->
 			    <option value="">All</option>
 			    <!--IF CONSIGNEE SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY CONSIGNEE -->
 		        <option value="Los Angeles">Los Angeles</option>
 		         <!--IF SHIPPER SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY SHIPPER-->
 		        <option value="Miami">Miami</option>
 			    </select>
			    </td>
							
				<!--COLUMN 2-->
                <td style="padding: 5px;">
				<select  id="filterby" name="filterby">
                <!--IF ALL SHOW DATE SELECT OPTIONS-->
                <option value="All">All</option>
                <!--IF SHIPPER SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY SHIPPER-->
                <option value="Shipper">Shipper</option>
                <!--IF RECEIPT # SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY RECEIPT-->
                <option value="Receipt">Receipt #</option>
                <!--IF BY DATE ONLY SHOW DATE SELECT OPTIONS-->
                <option value="Date">Date</option>
                <!--IF TRANSPORT SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY TRANSPORT-->
                <option value="Transport">Transport</option>
                <option value="Invoice">Invoice</option>
                <option value="Country">Country</option>
                </select>
			    </td>
                           
                <!-- IF ALL OR DATE SELECTED THIS SEARCH INPUT IS NOT USE-->
			   <!--COLUMN 3-->
               <td style="padding: 5px;">
			   <input type="hidden" placeholder="Search"  id="searchtext" name="searchtext">
		       </td>
			   
             <!-- column 4-->
               <td style="padding: 5px;"> 
			    <select id="filterdate" name="filterdate">
                     <option value="All">All</option>
                     <option value="Today">Today</option>
                     <option value="Yesterday">Yesterday</option>
                     <option value="This week">This week</option>
                     <option value="This month">This month</option>
                     <option value="Last month">Last month</option>	
                     <option value="Current year">Current Year</option>
                 </select>
			   </td>
			   		   
		  	   <td style="padding: 7px;" align="center">
				 <button id="btn_search" class="pure-button pure-button-primary">Search</button>
			   </td>
               
               </tr>
			   </table>
                    
                    
                    
                        </div>
						
		  	            <div class="col-md-6 col-xs-6">
						<div style="float:right; margin-top:26px; margin-right:18px;">	
							 <a class="pure-button pure-button-primary" href="#openModal" id='btn_repack' style="background:#E08566;"><b>Re-pack !</b></a>
			
	                    </div>
	                    </div>     
									
                    </div>
					
                  
                  
                    <div class="panel">
                        <div class="panel-body">

                        <ul id="list">
                            <div id="repack_table">
                                <% include RepackDynamicTable.ejs %>
                            </div>
                        </ul>
                        
                    </div>
                </div>
                   
            </div>
           
        </div>
 
        

</div>

<script>
    
    $("#btn_search").click(function(){
            update_table();
        });
          
        function update_table()
        {

            if($("#warehousefilter").val() == "")
                conditions = {"equalTo": {"Status":"Received"}};
            else
                conditions = {"equalTo": {"Status":"Received", Warehouse:$("#warehousefilter").val()}};
                
            InsertTable({
                    cols:   /*Columnas definidas FIELD:TITLE or FIELD:{FIELDNEEDED:FIELDTITLE}*/
                         {
                            
                            "Receipt":"",
                            "Shipper":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/
                            "ReceiptDate":"",
                            "Country":"",
                            "Volume":"",
                            "Warehouse":"",
                            "Invoice":"",
                            "Transport":""
                        },
                        
                    /* AL PASAR EL PARAMETRO COLLECTION INDICAMOS QUE NECESITAMOS BUSQUEDA CON LISTA DE RESULTADOS */
                    collection: "Warehouses", /* COLLECCION PRINCIPAL */
                    by: "Consignee",    /* CAMPO DE BUSQUEDA */
                    value: {__type: "Pointer", className: "Clients", objectId: usrID},
                    
                    /* CONDICIONES */
                    conditions: filter_conditions_with_dict({
                                                        conditions:conditions}),
                    
                    /*BUSQUEDA DE SEARCH TIPO LIKE*/
                    like: filter_like(),
                    
                    document: "Staff/Warehouses/repack_partitions/RepackDynamicTable",
                    itemid: "repack_table"
                });
        }
    
        
        function searchtext_keyup()
        {
            update_table();
        }
        
            
        $("#filterdate").change(function(){
            update_table();
        });

	  	$("#filterby").change(function(){
	
	  		if($("#filterby").val() == "Date")
	  		{
	  			$("#searchtext").replaceWith("<input type='text'  placeholder='From' id='searchtext' name='searchtext'>");
				$("#fromTxt").replaceWith("<label class='pfont' style='display: block;' id='fromTxt'>From:</label>");
                $("#toTxt").replaceWith("<label class='pfont' id='toTxt'>To:</label>");
                $("#filterdate").replaceWith("<input type='text'  placeholder='To' id='filterdate' name='filterdate'>");
            
                $( "#searchtext" ).datepicker();
                $( "#filterdate" ).datepicker(
                    {
                        onSelect: 
                            function(dateText, inst) 
                            {
                                update_table();
                            }
                        });
                        
	  		}
	          else if($("#filterby").val() == "volume")
	  		{
            
	  			$("#searchtext").replaceWith("<input type='text' placeholder='Search' id='searchtext' name='searchtext'><select id='volumecond' name='volumecond'><option value='lessthan'>Less than</option><option value='greaterthan'>Greater Than</option><option value='equal'>Equal</option></select>");
                $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");
            
            }
            else if($("#filterby").val() == "All")
	  		{
            
	  			$("#searchtext").replaceWith("<input type='hidden' placeholder='Search' id='searchtext' name='searchtext'>");
                $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");
				$("#fromTxt").replaceWith("<label class='pfont' style='display: none;' id='fromTxt'>From:</label>");
				 $("#toTxt").replaceWith("<label class='pfont' id='toTxt'>Date:</label>");
            
            }
            else
            {
	  			$("#searchtext").replaceWith("<input type='text' placeholder='Search' id='searchtext' name='searchtext'>");
                $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");
				$("#fromTxt").replaceWith("<label class='pfont' style='display: none;' id='fromTxt'>From:</label>");
				$("#toTxt").replaceWith("<label class='pfont' id='toTxt'>Date:</label>");
                
                /*$("#searchtext").keyup(searchtext_keyup);*/
            }
	  	});
		
		
	    $("#btn_repack").click(function(){
        
	        if(usrID == -1)
	        {
	            alert("User not selected");
	            return false;
	        }
        
	        var repack_text = "Repack detail:\n\n";
        
	        var checkboxes = document.getElementsByName("checkware");
      
	        for(i in checkboxes)
	        {
	            if(checkboxes[i].checked)
	            {
	                repack_items.push(checkboxes[i].id);
	                repack_text += "Receipt ID: " + checkboxes[i].id + "\n---------------------------\n";
	            }
	        }
        
	        /* NOT CHECKBOXES SELECTED? */
	        if(repack_items.length == 0)
	        {
	            alert("You must select almost one warehouse for repack");
	            return false;
	        }
        
	        $("#InternalNotes").val(repack_text);
        
	        /*
	        InsertForm2({
	                    params: {"warehouselist":repack_items, "internal_notes":repack_text, "usrID":usrID},
	                    document: "staff_RepackForm",
	                    itemid: "openModal"
	            });*/
            
	        /*$("#repack_content").replaceWith("<div id='openModal' class='modalDialog'><div><a href='#close' title='Close' class='close'>X</a><h2>Modal Box</h2><p>This is a sample modal box that can be created using the powers of CSS3.</p><p>You could do a lot of things here like have a pop-up ad that shows when your website loads, or create a login/register form for users.</p></div></div>");
	        */
        
	    });
       
</script>

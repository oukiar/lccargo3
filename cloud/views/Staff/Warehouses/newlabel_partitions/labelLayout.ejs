<%
    moment = require('cloud/moment');
%>



<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=960">
		 <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=VT323">	
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Jura&amp;subset=all">
		<title>Page 1</title>

        
        <!-- PDF INCLUDES -->
        <link rel="stylesheet" type="text/css" href="/cod/css/site.20150716102647.css">
        <script src="/cod/js/jquery-1.11.2.min.js"></script>
        <script src="/cod/js/jspdf.min.js"></script>
        <script src="/cod/js/html2canvas.min.js"></script>
        <script src="/canvas2image/canvas2image.js"></script>
        <script src="/cod/js/base64.min.js"></script>


	</head>
	<body id="body" style="width:6.4in; height:4in;">
        
        <img id="img_working" src="/web/img/icons/loader_grey.gif">
        <h1 style="font-size: 20px;">Preparando impresion: </h1><div style="font-size: 20px;" id="renderedLabels">0</div>

        <!--
        <button onclick="getPDF();" style="width:200;height:50;font-size: 20px;">Get PDF</button>
        <button onclick="realPrint();" style="width:200;height:50;font-size: 20px;">Print PDF</button>
        -->
        
        <% var i=0; boxes.forEach(function(box){ %>
        
            <div id="mylabel-<%=box.get("BoxNum")%>">


		<div class="section">
			<div class="cont">
				<div class="colwrapper">
					<div class="cont-2">
						<div class="cont-3">
							<div class="colwrapper-2">
								<div class="cont-4"></div>
								<div class="cont-5">
									<div class="cont-6"><p class="para"><span class="font">Length</span></p></div>
								</div>
							</div>
							<div class="colwrapper-3">
								<div class="cont-7">
									<div class="cont-8">
										<div class="cont-9"><p class="para-2"><span class="font-2">Width</span></p></div>
									</div>
								</div>
							</div>
							<div class="colwrapper-4">
								<div class="cont-10">
									<div class="cont-11">
										<div class="cont-12"><p class="para-3"><span class="font-3">Height</span></p></div>
									</div>
								</div>
							</div>
							<div class="colwrapper-5">
								<div class="cont-13">
									<div class="cont-14">
										<div class="cont-15"><p class="para-4"><span class="font-4">Volume</span></p></div>
									</div>
								</div>
							</div>
							<div class="colwrapper-6">
								<div class="cont-16">
									<div class="cont-17">
										<div class="cont-18"><p class="para-5"><span class="font-5">Weight-Vol.</span></p></div>
									</div>
								</div>
							</div>
							<div class="colwrapper-7">
								<div class="cont-19">
									<div class="cont-20">
										<div class="cont-21"><p class="para-6"><span class="font-6">Weight</span></p></div>
									</div>
								</div>
							</div>
						</div>
						<div class="cont-22">
							<div class="colwrapper-8">
								<div class="cont-23">
									<div class="cont-24"><p class="para-7"><span class="font-7">134511</span></p></div>
								</div>
							</div>
							<div class="colwrapper-9">
								<div class="cont-25">
									<div class="cont-26"><p class="para-8"><span class="font-8">13451</span></p></div>
								</div>
							</div>
							<div class="colwrapper-10">
								<div class="cont-27">
									<div class="cont-28"><p class="para-9"><span class="font-9">13451</span></p></div>
								</div>
							</div>
							<div class="colwrapper-11">
								<div class="cont-29">
									<div class="cont-30"><p class="para-10"><span class="font-10">13451</span></p></div>
								</div>
							</div>
							<div class="colwrapper-12">
								<div class="cont-31">
									<div class="cont-32"><p class="para-11"><span class="font-11">13451</span></p></div>
								</div>
							</div>
							<div class="colwrapper-13">
								<div class="cont-33">
									<div class="cont-34"><p class="para-12"><span class="font-12">13451</span></p></div>
								</div>
							</div>
						</div>
						<div class="cont-35">
							<div class="colwrapper-14">
								<div class="cont-36">
									<div class="cont-37"><p class="para-13"><span class="font-13">Shipper:</span></p></div>
								</div>
								<div class="cont-38">
									<div class="cont-39"><p class="para-14"><span class="font-14">Mario Salvador Diaz Durand de la Colonia</span></p></div>
								</div>
								<div class="cont-40">
									<div class="colwrapper-15">
										<div class="cont-41">
											<div class="cont-42"><p class="para-15"><span class="font-15">Zone:</span></p></div>
										</div>
									</div>
									<div class="colwrapper-16">
										<div class="cont-43">
											<div class="cont-44"><p class="para-16"><span class="font-16">900123-123</span></p></div>
										</div>
									</div>
								</div>
								<div class="cont-45">
									<div class="cont-46"><p class="para-17"><span class="font-17">Time:</span></p></div>
								</div>
							</div>
							<div class="colwrapper-17">
								<div class="cont-47"></div>
							</div>
							<div class="colwrapper-18">
								<div class="cont-48">
									<div class="cont-49"><p class="para-18"><span class="font-18">Consignee:</span></p></div>
								</div>
								<div class="cont-50">
									<div class="cont-51"><p class="para-19"><span class="font-19">Mario Salvador Diaz Durand de la Colonia</span></p></div>
								</div>
								<div class="cont-52">
									<div class="colwrapper-19">
										<div class="cont-53">
											<div class="cont-54"><p class="para-20"><span class="font-20">Receipt by:</span></p></div>
										</div>
									</div>
									<div class="colwrapper-20">
										<div class="cont-55">
											<div class="cont-56"><p class="para-21"><span class="font-21">User who recives</span></p></div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="cont-57">
							<div class="colwrapper-21">
								<div class="cont-58">
									<div class="cont-59"><p class="para-22"><span class="font-22">&nbsp;5/5/2015&nbsp;&nbsp;8:38:29</span></p></div>
								</div>
							</div>
							<div class="colwrapper-22">
								<div class="cont-60">
									<div class="cont-61"><p class="para-23"><span class="font-23">ALL CARGO IS SUBJECT TO INSPECTION</span></p></div>
								</div>
							</div>
							<div class="colwrapper-23">
								<div class="cont-62">
									<div class="cont-63"><p class="para-24"><span class="font-24">Box:</span></p></div>
								</div>
							</div>
							<div class="colwrapper-24">
								<div class="cont-64">
									<div class="cont-65"><p class="para-25"><span class="font-25">&nbsp;<%= box.get("Num")%></span></p></div>
								</div>
							</div>
						</div>
					</div>
					<div class="cont-66">
						<div class="cont-67">
							<div class="cont-68"><p class="para-26"><span class="font-26"><%= receipt.get("Company").get("Name") %></span></p></div>
						</div>
						<div class="cont-69">
							<div class="colwrapper-25">
								<div class="cont-70">
									<div class="cont-71"><p class="para-27"><span class="font-27">&nbsp;# 00124123</span></p></div>
								</div>
							</div>
							<div class="colwrapper-26">
								<div class="cont-72">
									<div class="cont-73"><p class="para-28"><span class="font-28">-</span></p></div>
								</div>
							</div>
							<div class="colwrapper-27">
								<div class="cont-74">
									<div class="cont-75"><p class="para-29"><span class="font-29">Destination</span></p></div>
								</div>
							</div>
						</div>
					</div>
					<div class="cont-76">
						<div class="colwrapper-28">
							<div class="cont-77"></div>
							<div class="cont-78"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

            </div>

        
        <% i+=1; }) %>  
        
	</body>

</html>



<script type="text/javascript">
    var androidBrowserVersion = RegExp(/Mozilla\/5\.0 \(Linux; .; Android ([\d.]+)/).exec(navigator.userAgent);
    if(androidBrowserVersion && parseFloat(androidBrowserVersion[1]) < 5) { document.getElementsByTagName('body')[0].className+=' whitespacefix'; }
</script>

<script>
    var labels = [];

    var lbcounter = 0;
    
    var cachepdf = jsPDF('l', 'in', [6,4]);

    $( document ).ready( function(){
            window.setTimeout(worker, 500);
        });
        
    function worker()
    {
                
        html2canvas($("#mylabel-" + lbcounter.toString() ), {
            onrendered: function(canvas) {
                            
                if(lbcounter > 0)
                    cachepdf.addPage();
                    
                cachepdf.addImage(canvas, "PNG", 0,0,6,4);
                
                lbcounter += 1;
                
                $("#renderedLabels").html(lbcounter);
                
                if(lbcounter < <%=receipt.get("TotalBoxes")%>)
                    window.setTimeout(worker, 100);
                else
                {
                    $("#renderedLabels").html("Ready");
                    $("#img_working").replaceWith("");
                    
                    window.setTimeout(realPrint, 1000);
                    
                }
            }
        });
        
    }
    
    function realPrint()
    {
        cachepdf.autoPrint();
        cachepdf.output('dataurlnewwindow');
    }

    function getPDF()
    {              
        cachepdf.save("Labels.pdf");
    }
    
    
    

    
</script>


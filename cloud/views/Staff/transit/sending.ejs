<!DOCTYPE html>
<html>
    <head>
		
        <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
        <meta charset="utf-8" />
        <title>LC Cargo</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta content="" name="description" />
        <meta content="" name="author" />
        <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Jura&amp;subset=all">
       
	
   <!--ADMIN REQUIREMENTS-->   
  <% include ../../generals/ultraAdmin.ejs %>
	
    
        <script src="/cod/js/common.js"></script>
        <script src="/cod/js/moment.js"></script>
    
        <script src="/cod/js/jquery-1.11.2.min.js"></script>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
	
    
    </head>
    <!-- END HEAD -->

    <!-- BEGIN BODY -->
    <body>
		<!--START TOPBAR-->
		 <% include ../../generals/topbar.ejs %>
		 
        <!-- START CONTAINER -->
        <div class="page-container row-fluid">
        <!-- SIDEBAR - START -->
		 <% include ../../generals/sideBar.ejs %>
        <!--  SIDEBAR - END -->
			
			
            <!-- START CONTENT -->
          
           <section class="wrapper" style='margin-top:60px;display:inline-block;width:100%;padding:15px 0 0 15px;'>
              
              <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>
              <div class="page-title">
              <div class="pull-left">
		  			  <% include transitMenu.ejs %>
              <h1 class="title">In Transit - Sending</h1>
			
            <div id="content">
            <% include sending/table.ejs %>
            </div>

		      </div>
              </div>
              </div>
            </section>
            </section>
            <!-- END CONTENT -->


        </div><!-- END CONTAINER -->
		

			</div>
        <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->
<%include ../../generals/endFiles.ejs%>

<script>

        
        function update_table()
        {
                
            InsertTable({
                    cols:   /*Columnas definidas FIELD:TITLE or FIELD:{FIELDNEEDED:FIELDTITLE}*/
                         {
                            
                            "Receipt":"",
                            "Consignee":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/
                            "Shipper":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/
                            "Invoice":"",
                            "ReceiptDate":"",
                            "Country":"",
                            "Transport":"",
                            "Warehouse":"",
			                "Shipment":"",
			                "Status":"",
                            "objectId":""
                        },
                        
                    /* AL PASAR EL PARAMETRO COLLECTION INDICAMOS QUE NECESITAMOS BUSQUEDA CON LISTA DE RESULTADOS */
                    collection: "Warehouses", /* COLLECCION PRINCIPAL */
                    
                    /* CONDICIONES */
                    conditions: filter_conditions_with_dict({
                                                conditions:{equalTo:{Warehouse:$("#warehousefilter").val()}}
                                                }),
                    
                    /*BUSQUEDA DE SEARCH TIPO LIKE*/
                    like: filter_like_with_dict({like:{"Status":"TransferOut"}}),
                    
                    document: "Staff/transit/sending/dynamicTable",
                    itemid: "ware_table"
                });        
        }

    $("#btn_saveclassify").click(
        function()
        {
            checkboxes = document.getElementsByName("checkship");
            
            for(i in checkboxes)
            {
                if(checkboxes[i].checked)
                {        
                
                    var str = "<img id='save-" + checkboxes[i].id + "' src='/web/img/icons/loader_grey.gif' width=16 height=16>  " + checkboxes[i].id + "<br>";
                        
                    $("#classify_items").append( str );
                    
                    kwargs = {
                                collection:"Warehouses", 
                                objectId: checkboxes[i].id,
                                values:{Status:"NotProcessed", "Shipment":$("#shipment").val()}
                            };                                               
                        
                    $.post("/update", 
                        kwargs, 
                        function(data)
                        {
                            kwargs = JSON.parse(data);
                            $("#save-" + kwargs["objectId"]).replaceWith("SAVED");
                        }
                    );
                }
            }
            
            
        });

    $("#btn_closeclassifydialog").click(function(){
        update_table();
    });
    
    $("#btn_savetrans").click(function(){
        
            var warehouse = $("#waretransfer").val();
            $("#transfersection").replaceWith("<img id='transfersection' src='/web/img/icons/loader_grey.gif'>");
        
            $.post("/update", {collection:"Warehouses", 
                    objectId:transferId, 
                    values:{"Status":"InTransfer", "Warehouse":warehouse }}, 
                    function(data){
                        $("#transfersection").replaceWith("DONE !");
                        
                        update_table();
                        
                        });
        });

</script>
	
    
        <!-- modal end -->
    </body>
</html>

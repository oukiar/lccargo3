<% var companyID = Parse.User.current().get("Company").id%><!DOCTYPE html><html ng-app="myApp">    <head>		        <meta http-equiv="content-type" content="text/html;charset=UTF-8" />        <meta charset="utf-8" />        <title>LC Cargo</title>        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />        <meta content="" name="description" />        <meta content="" name="author" />		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=VT323">        <!--ADMIN REQUIREMENTS-->           <% include ../../generals/ultraAdmin.ejs %>        <script src="/cod/js/moment.js"></script>        <script src="/cod/js/common.js"></script>        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css" />        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">        <script src="//code.jquery.com/jquery-1.10.2.js"></script>        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>        <link rel="stylesheet" href="/resources/demos/style.css">                       <script src="//www.parsecdn.com/js/parse-1.4.2.min.js"></script>                </head>        <!-- END HEAD -->        <!-- BEGIN BODY -->        <body class=" ">		<!--START TOPBAR-->		<% include ../../generals/topbar.ejs %>         <!-- START CONTAINER -->        <div class="page-container row-fluid">        <!-- SIDEBAR - START -->        <!--  SIDEBAR - END -->	        <!-- START CONTENT -->        <section class="wrapper" style='display:inline-block;width:100%;'>        <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>        <div class="page-title">             <% include clientsMenu.ejs%>            <h1 class="title" style="font-family: 'VT323', serif; font-size:50px; padding-left:13px;">Clients - Pending</h1>			<div id="content">			<% include pendings_partitions/table.ejs %>                                </div>                              </div>                       </div>                   </section>		               <!-- END CONTENT -->              </div><!-- END CONTAINER -->  		</div>              <div id="openModal" class="modalDialog">        <div>            <a href="#close" title="Close" class="close">X</a>            <img src="assets/images/client.png" width="89" height="89" alt="Client" style="margin-top:5px;">            <h2>Activate client's account.</h2>            <table>            <tr>            <td><b>Name:</b></td>            <td style="padding:0 34px 0 2px;" id="clientName">Jose Abella Eggleton Ramirez</td>            <td style="padding:0 1px 0 2px;"><b></b></td>            <td></td>            </tr>            <tr>            <td><b>Tel:</b></td>            <td id="clientTel">Jose</td>            <td><b>Email:</b></td>            <td id="clientEmail">Jose</td>            </tr>            </table>            </br>            <form class="form-inline" method="POST" action="/activateClient">                            <a href="#close" class="btn btn-primary" id="btn_activate">Activate</a>            </form>            </br>            </br>        </div>    </div>        <!-- END CONTAINER -->        <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->        <%include ../../generals/endFiles.ejs%>        <!-- modal end -->            <script>            Parse.initialize("XEPryFHrd5Tztu45du5Z3kpqxDsweaP1Q0lt8JOb", "MDhb1hBngr2tx2v9TjyzoUhMcOFeWGJ56TWvChqi");            /* GLOBAL USER */    var user;    /* OBTENCION Y ALMACENAMIENTO DEL CURRENT USER PARA USARSE CLIENTSIDE */    var query = new Parse.Query("User");        query.descending('createdAt');    query.include("Company");        query.get("<%= user.id%>", {        success:             function(object)            {                /* SAVE USER FOR FUTURE OPERATIONS */                user = object;                            }        });            $("#btn_activate").click(function(){                        var query = new Parse.Query("Clients");            query.get(clientID, {success: function(clientres){				                      clientres.set("Status", "Active");                    clientres.save({success: function(){                                                        $.post("/get_activation_template_clientPending", {clientID:clientID, companyID:user.get("Company").id}, function(template){                                                                                                                            /* EMAIL PARAMETERS */                                    emailparams = {                                                    "text": template,                                                    "subject": "Account activated",                                                    "from_email": "cargoparse@notifications.com",                                                    "from_name":"Notifier",                                                    "to_email": clientres.get("Email"),                                                    "to_name":clientres.get("Name")                                                };                                                                                                        /* SEND EMAIL */                                    Parse.Cloud.run('sendMail', emailparams, {                                        success:                                             function(result)                                             {                                                /*alert(result);*/                                            },                                        error:                                            function()                                            {                                                alert("Email was not send");                                            }                                        });                                                                          update_table();                                    alert("Activated");                                                                    });                        }});                }});                                });                function update_table()        {                           conditions = {equalTo:{"Status":"Pending",                                    "Company":{__type: "Pointer", className: "Companies", objectId: user.get("Company").id} }};                                                            InsertTable({                    cols:                            {                                                        "Name":"",                            "Country":"",                             "Company":{"name":""},                            "Address":"",                            "Telephone":"",                            "Email":"",                            "objectId":""                        },                    collection: "Clients",                     conditions: conditions,                    like: filter_like(),                    document: "Staff/Clients/pendings_partitions/dynamictable",                    itemid: "clientstable"                });                               }        $("#btn_search").click(function(){                if($("#searchtext").val() == "")                {                    alert("Search text void, please enter keyword to find");                }                else                    update_table();            });             $("#filterby").change(function()            {                filterby_changed();             });            </script>            </body>	</html>